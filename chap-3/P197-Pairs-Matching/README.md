# P197 二人組（一般マッチング)
2*N人の人間がいる。二人組を組ませるが、友達としか組めない。整数Nと交友関係を表す(2*N) * (2*N)の隣接行列が与えられるので、作れる最大の二人組の数を答える問題。  
  
tutte行列とかいうものを使って解くらしい。  
tutte行列とは、この場合(2*N) * (2*N)の行列で、各成分をt_(u,v)とする。  
uとvの間に辺が張られていた場合、  
t_(u,v) = x_(u,v)  
t_(v,u) = - x_(u,v)  
張られていなれけば  
t_(u,v) = 0  
とした歪対称な行列のこと。(多分ね)  
  
Tutteの定理とかいって、「元のグラフに完全マッチングが存在することと、tutte行列式が恒等的に0でないのは等価。」らしい。 
  
よって、さっきのx_eを乱数(代入するたびに作る)にして、与えられた交友関係をもとにTutte行列を作り、行列式を計算すれば、それが0かどうかで完全マッチングが存在するかどうか判定できる。  
  
また、理由が理解できなかったが、Tutte行列のランク数が最大マッチングの頂点数に等しくなるそうだ。  
なので、Tutteの行列式を作りランク数をカウントしそれを2で割る(頂点数2つにつきペア1個なので)することで問題に答えられる。  
  
乱数を参考URL#2にならってdoubleにするのか、それともintにするのかで2バージョン作った。  
(テストケースがちっちゃいからか参考URL#2のような問題は発生しなかった。)  
参考URL#1によれば、この乱数は範囲に(2^k)程度の幅があるとき、Schwarts-Zippelの補題というやつから「本当は完全マッチングが存在するのに、存在しないと判定してしまう確率がn/2^k以下」  
だそうなので、その式を参考に適当に乱数の範囲を決めた。  

#  参考
[Tutte行列とか](http://www.kurims.kyoto-u.ac.jp/~takazawa/coss2011/okamoto-handout.pdf)  
[Tutte行列を使った、一般グラフの最大マッチングの求め方](http://logfiles.hatenablog.com/entry/2016/10/30/143025)
[Tutte行列の簡単な説明](http://logfiles.hatenablog.com/entry/2016/10/30/143025)
